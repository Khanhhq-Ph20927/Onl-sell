<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" data-bs-theme="light" data-footer="dark">
<head th:replace="client/fragments/head::head"></head>
<body>
<div th:replace="client/fragments/header::header"></div>
<!--cart -->
<div th:replace="client/fragments/cart::cart"></div>

<!-- Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content rounded">
            <div class="modal-header p-3">
                <div class="position-relative w-100">
                    <input
                            type="text"
                            class="form-control form-control-lg border-2"
                            placeholder="Search for Toner..."
                            autocomplete="off"
                            id="search-options"
                            value=""
                    />
                    <span class="bi bi-search search-widget-icon fs-17"></span>
                    <a
                            href="javascript:void(0);"
                            class="search-widget-icon fs-14 link-secondary text-decoration-underline search-widget-icon-close d-none"
                            id="search-close-options"
                    >Clear</a
                    >
                </div>
            </div>
            <div
                    class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0 overflow-hidden"
                    id="search-dropdown"
            >
                <div class="dropdown-head rounded-top">
                    <div class="p-3">
                        <div class="row align-items-center">
                            <div class="col">
                                <h6 class="m-0 fs-14 text-muted fw-semibold">
                                    RECENT SEARCHES
                                </h6>
                            </div>
                        </div>
                    </div>

                    <div class="dropdown-item bg-transparent text-wrap">
                        <a
                                href="index.html"
                                class="btn btn-soft-secondary btn-sm btn-rounded"
                        >how to setup <i class="mdi mdi-magnify ms-1 align-middle"></i
                        ></a>
                        <a
                                href="index.html"
                                class="btn btn-soft-secondary btn-sm btn-rounded"
                        >buttons <i class="mdi mdi-magnify ms-1 align-middle"></i
                        ></a>
                    </div>
                </div>

                <div
                        data-simplebar
                        style="max-height: 300px"
                        class="pe-2 ps-3 my-3"
                >
                    <div class="list-group list-group-flush border-dashed">
                        <div class="notification-group-list">
                            <h5
                                    class="text-overflow text-muted fs-13 mb-2 mt-3 text-uppercase notification-title"
                            >
                                Apps Pages
                            </h5>
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            ><i class="bi bi-speedometer2 me-2"></i>
                                <span>Analytics Dashboard</span></a
                            >
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            ><i class="bi bi-filetype-psd me-2"></i>
                                <span>Toner.psd</span></a
                            >
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            ><i class="bi bi-ticket-detailed me-2"></i>
                                <span>Support Tickets</span></a
                            >
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            ><i class="bi bi-file-earmark-zip me-2"></i>
                                <span>Toner.zip</span></a
                            >
                        </div>

                        <div class="notification-group-list">
                            <h5
                                    class="text-overflow text-muted fs-13 mb-2 mt-3 text-uppercase notification-title"
                            >
                                Links
                            </h5>
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            ><i class="bi bi-link-45deg me-2 align-middle"></i>
                                <span>www.themesbrand.com</span></a
                            >
                        </div>

                        <div class="notification-group-list">
                            <h5
                                    class="text-overflow text-muted fs-13 mb-2 mt-3 text-uppercase notification-title"
                            >
                                People
                            </h5>
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            >
                                <div class="d-flex align-items-center">
                                    <img
                                            src="../assets/images/users/avatar-1.jpg"
                                            alt=""
                                            class="avatar-xs rounded-circle flex-shrink-0 me-2"
                                    />
                                    <div>
                                        <h6 class="mb-0">Ayaan Bowen</h6>
                                        <span class="fs-12 text-muted">React Developer</span>
                                    </div>
                                </div>
                            </a>
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            >
                                <div class="d-flex align-items-center">
                                    <img
                                            src="../assets/images/users/avatar-7.jpg"
                                            alt=""
                                            class="avatar-xs rounded-circle flex-shrink-0 me-2"
                                    />
                                    <div>
                                        <h6 class="mb-0">Alexander Kristi</h6>
                                        <span class="fs-12 text-muted">React Developer</span>
                                    </div>
                                </div>
                            </a>
                            <a
                                    href="javascript:void(0);"
                                    class="list-group-item dropdown-item notify-item"
                            >
                                <div class="d-flex align-items-center">
                                    <img
                                            src="../assets/images/users/avatar-5.jpg"
                                            alt=""
                                            class="avatar-xs rounded-circle flex-shrink-0 me-2"
                                    />
                                    <div>
                                        <h6 class="mb-0">Alan Carla</h6>
                                        <span class="fs-12 text-muted">React Developer</span>
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- removeItemModal -->
<div
        id="removeItemModal"
        class="modal fade zoomIn"
        tabindex="-1"
        aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                        id="close-modal"
                ></button>
            </div>
            <div class="modal-body">
                <div class="mt-2 text-center">
                    <lord-icon
                            src="https://cdn.lordicon.com/gsqxdxog.json"
                            trigger="loop"
                            colors="primary:#f7b84b,secondary:#f06548"
                            style="width: 100px; height: 100px"
                    ></lord-icon>
                    <div class="mt-4 pt-2 fs-15 mx-4 mx-sm-5">
                        <h4>Are you sure ?</h4>
                        <p class="text-muted mx-4 mb-0">
                            Are you sure you want to remove this product ?
                        </p>
                    </div>
                </div>
                <div class="d-flex gap-2 justify-content-center mt-4 mb-2">
                    <button
                            type="button"
                            class="btn w-sm btn-light"
                            data-bs-dismiss="modal"
                    >
                        Close
                    </button>
                    <button
                            type="button"
                            class="btn w-sm btn-danger"
                            id="remove-product"
                    >
                        Yes, Delete It!
                    </button>
                </div>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<div
        class="modal fade"
        id="subscribeModal"
        tabindex="-1"
        aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content border-0">
            <div class="modal-body p-0 bg-info-subtle rounded">
                <div class="row g-0 align-items-center">
                    <div class="col-lg-6">
                        <div class="p-4 h-100">
                  <span class="badge bg-info-subtle text-info fs-13"
                  >GET 10% SALE OFF</span
                  >
                            <h2 class="display-6 mt-2 mb-3">
                                Subscribe & Get <b>50% Special</b> Discount On Email
                            </h2>
                            <p class="mb-4 pb-lg-2 fs-16">
                                Join our newsletter to receive the latest updates and
                                promotion
                            </p>
                            <form action="#!">
                                <div class="position-relative ecommerce-subscript">
                                    <input
                                            type="email"
                                            class="form-control rounded-pill border-0"
                                            placeholder="Enter your email"
                                    />
                                    <button
                                            type="submit"
                                            class="btn btn-info btn-hover rounded-pill"
                                    >
                                        Subscript
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="p-4 pb-0">
                            <img
                                    src="../assets/images/subscribe.png"
                                    alt=""
                                    class="img-fluid"
                            />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- end modal -->
<div th:replace="client/fragments/chat::chat"></div>
<section class="section pb-0 mt-4">
    <div class="container-fluid">
        <div class="row g-2">
            <div class="col-lg-7">
                <a
                        href="#!"
                        class="product-banner-1 mt-4 mt-lg-0 rounded overflow-hidden d-block"
                >
                    <img
                            src="../assets/images/ecommerce/features/img-5.jpg"
                            class="w-100 rounded object-fit-cover"
                            alt=""
                            style="max-height: 480px"
                    />
                    <div class="product-content p-3 ps-5" style="max-width: 390px">
                        <p class="text-uppercase fs-15 text-secondary fw-semibold mb-2">
                            New Arrival
                        </p>
                        <h1 class="display-5 lh-base text-dark ff-secondary">
                            Trendy Fashion Clothes
                        </h1>
                        <div class="product-btn mt-4">
                            Shop Now <i class="bi bi-arrow-right ms-2"></i>
                        </div>
                    </div>
                </a>
            </div>
            <!--end col-->
            <div class="col-lg-5">
                <div class="row g-2">
                    <div class="col-lg-12">
                        <a
                                href="#!"
                                class="product-banner-1 mt-4 mt-lg-0 rounded overflow-hidden d-block"
                        >
                            <img
                                    src="../assets/images/ecommerce/features/img-4.jpg"
                                    class="w-100 rounded object-fit-cover"
                                    alt=""
                                    style="max-height: 236px"
                            />
                            <div class="product-content p-3 ps-5">
                                <p class="text-uppercase fw-semibold fs-14 mb-2">
                                    Back Friday Sale
                                </p>
                                <h1 class="lh-base ff-secondary text-dark fw-medium">
                                    Biggest Jewelry Collection
                                </h1>
                            </div>
                        </a>
                    </div>
                    <!--end col-->
                    <div class="col-lg-12">
                        <a
                                href="#!"
                                class="product-banner-1 mt-4 mt-lg-0 rounded overflow-hidden d-block"
                        >
                            <img
                                    src="../assets/images/ecommerce/features/img-1.jpg"
                                    class="w-100 rounded object-fit-cover"
                                    alt=""
                                    style="max-height: 236px"
                            />
                            <div class="product-content p-3 ps-5">
                                <h1 class="lh-base ff-secondary text-dark fw-medium">
                                    Women's Sportwere Sales
                                </h1>
                                <div class="product-btn mt-4">
                                    Shop Now <i class="bi bi-arrow-right ms-2"></i>
                                </div>
                            </div>
                        </a>
                    </div>
                    <!--end col-->
                </div>
                <!--end row-->
            </div>
            <!--end col-->
        </div>
        <!--end row-->
    </div>
    <!--end container-->
</section>

<div class="position-relative section">
    <div class="container">
        <div class="ecommerce-product gap-4">
            <div class="sidebar small-sidebar flex-shrink-0">
                <div class="card overflow-hidden">
                    <div class="card-header">
                        <div class="d-flex mb-3">
                            <div class="flex-grow-1">
                                <h5 class="fs-16">Filters</h5>
                            </div>
                            <div class="flex-shrink-0">
                                <button onclick="ClearAll()"
                                        class="btn btn-hover text-decoration-underline link-secondary" id="clearall"
                                >Clear All
                                </button
                                >
                            </div>
                        </div>

                        <div class="search-box">
                            <input
                                    type="text"
                                    class="form-control"
                                    id="searchProductList"
                                    autocomplete="off"
                                    placeholder="Search Products..."
                                    onchange="searchProduct()"
                            />
                            <i class="ri-search-line search-icon"></i>
                        </div>
                    </div>

                    <div class="accordion accordion-flush filter-accordion">

                        <div class="card-body border-bottom">
                            <p class="text-muted text-uppercase fs-13 fw-medium mb-4">
                                Price
                            </p>
                            <div id="product-price-range" data-slider-color="info"
                                 class="noUi-target noUi-ltr noUi-horizontal noUi-txt-dir-ltr">
                            </div>
                            <div class="formCost d-flex gap-2 align-items-center mt-3">
                                <input
                                        class="form-control form-control-sm"
                                        type="text"
                                        id="minCost"
                                />
                                <span class="fw-semibold text-muted">to</span>
                                <input
                                        class="form-control form-control-sm"
                                        type="text"
                                        id="maxCost"
                                />
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingColors">
                                <button
                                        class="accordion-button bg-transparent shadow-none"
                                        type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#flush-collapseColors"
                                        aria-expanded="true"
                                        aria-controls="flush-collapseColors"
                                >
                      <span class="text-muted text-uppercase fs-13 fw-medium"
                      >Colors</span
                      >
                                    <span
                                            class="badge bg-success rounded-pill align-middle ms-1 filter-badge"
                                    ></span>
                                </button>
                            </h2>

                            <div
                                    id="flush-collapseColors"
                                    class="accordion-collapse collapse show"
                                    aria-labelledby="flush-headingColors"
                            >
                                <div class="accordion-body text-body pt-0">
                                    <ul
                                            class="clothe-colors list-unstyled hstack gap-3 mb-0 flex-wrap"
                                            id="color-filter"
                                    >
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="1"
                                                    id="color-7"
                                                    onclick="chooseFilterColor(1)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-dark p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-7"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="2"
                                                    id="color-8"
                                                    onclick="chooseFilterColor(2)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-light p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-8"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="3"
                                                    id="color-4"
                                                    onclick="chooseFilterColor(3)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-danger p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-4"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="4"
                                                    id="color-2"
                                                    onclick="chooseFilterColor(4)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-info p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-2"
                                                    style="background-color: rgb(169,169,169); border: none;"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="5"
                                                    id="color-1"
                                                    onclick="chooseFilterColor(5)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-success p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-1"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="6"
                                                    id="color-6"
                                                    onclick="chooseFilterColor(6)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-secondary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-6"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="7"
                                                    id="color-5"
                                                    onclick="chooseFilterColor(7)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-5"
                                            ></label>
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="colors"
                                                    value="8"
                                                    id="color-3"
                                                    onclick="chooseFilterColor(8)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-warning p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="color-3"
                                            ></label>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <!-- end accordion-item -->

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="flush-headingSize">
                                <button
                                        class="accordion-button bg-transparent shadow-none"
                                        type="button"
                                        data-bs-toggle="collapse"
                                        data-bs-target="#flush-collapseSize"
                                        aria-expanded="true"
                                        aria-controls="flush-collapseSize"
                                >
                      <span class="text-muted text-uppercase fs-13 fw-medium"
                      >Sizes</span
                      >
                                    <span
                                            class="badge bg-success rounded-pill align-middle ms-1 filter-badge"
                                    ></span>
                                </button>
                            </h2>

                            <div
                                    id="flush-collapseSize"
                                    class="accordion-collapse collapse show"
                                    aria-labelledby="flush-headingSize"
                            >
                                <div class="accordion-body text-body pt-0">
                                    <ul
                                            class="clothe-size list-unstyled hstack gap-3 mb-0 flex-wrap"
                                            id="size-filter"
                                    >
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="s"
                                                    id="size1"
                                                    onclick="chooseFilterSize(1)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size1"
                                            >S</label
                                            >
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="m"
                                                    id="size2"
                                                    onclick="chooseFilterSize(2)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size2"
                                            >M</label
                                            >
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="l"
                                                    id="size3"
                                                    onclick="chooseFilterSize(3)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size3"
                                            >L</label
                                            >
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="xl"
                                                    id="size4"
                                                    onclick="chooseFilterSize(4)"

                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size4"
                                            >XL</label
                                            >
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="xxl"
                                                    id="size5"
                                                    onclick="chooseFilterSize(5)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size5"
                                            >XXL</label
                                            >
                                        </li>
                                        <li>
                                            <input
                                                    type="checkbox"
                                                    name="sizes"
                                                    value="2xl"
                                                    id="size6"
                                                    onclick="chooseFilterSize(6)"
                                            />
                                            <label
                                                    class="avatar-xs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle"
                                                    for="size6"
                                            >2XL</label
                                            >
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end card -->
            </div>
            <div class="flex-grow-1">
                <div class="d-flex align-items-center gap-2 mb-4">
                    <p class="text-muted flex-grow-1 mb-0">
                        Showing 1-12 of 84 results
                    </p>

                    <div class="flex-shrink-0">
                        <div class="d-flex gap-2">
                            <div class="flex-shrink-0">
                                <label for="sort-elem" class="col-form-label"
                                >Sắp Xếp:</label
                                >
                            </div>
                            <div class="flex-shrink-0">
                                <select class="form-select w-md" id="sort-elem" onchange="loadPage(page)">
                                    <option value="0">Tất Cả</option>
                                    <option value="1">A-Z</option>
                                    <option value="2">Z-A</option>
                                    <option value="3">Giá Tăng Dần</option>
                                    <option value="4">Giá Giảm Dần</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row" id="product-grid">
                </div>
                <div class="row" id="pagination-element">
                </div>

                <div class="row d-none" id="search-result-elem">
                    <div class="col-lg-12">
                        <div class="text-center py-5">
                            <div class="avatar-lg mx-auto mb-4">
                                <div
                                        class="avatar-title bg-primary-subtle text-primary rounded-circle fs-24"
                                >
                                    <i class="bi bi-search"></i>
                                </div>
                            </div>

                            <h5>No matching records found</h5>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--end container-->
</div>

<section
        class="section bg-light bg-opacity-25"
        style="
        background-image: url('../assets/images/ecommerce/bg-effect.png');
        background-position: center;
        background-size: cover;
      "
>
    <div class="container">
        <div class="row align-items-center justify-content-between">
            <div class="col-lg-6">
                <div>
                    <p class="fs-15 text-uppercase fw-medium">
                        <span class="fw-semibold text-danger">25% Up to</span> off all
                        Products
                    </p>
                    <h1 class="lh-base text-capitalize mb-3">
                        Stay home & get your daily needs from our shop
                    </h1>
                    <p class="fs-15 mb-4 pb-2">
                        Start You'r Daily Shopping with
                        <a href="#!" class="link-info fw-medium">Toner</a>
                    </p>
                    <form action="#!">
                        <div class="position-relative ecommerce-subscript">
                            <input
                                    type="email"
                                    class="form-control rounded-pill"
                                    placeholder="Enter your email"
                            />
                            <button
                                    type="submit"
                                    class="btn btn-primary btn-hover rounded-pill"
                            >
                                Subscript Now
                            </button>
                        </div>
                    </form>
                </div>
            </div>
            <!--end col-->
            <div class="col-xxl-2">
                <div class="mt-4 mt-lg-0">
                    <img
                            src="../assets/images/ecommerce/subscribe.png"
                            alt=""
                            class="img-fluid"
                    />
                </div>
            </div>
            <!--end col-->
        </div>
        <!--end row-->
    </div>
    <!--end container-->
</section>
<div th:replace="client/fragments/footer::footer"></div>
<div th:replace="client/fragments/script::script"></div>
<script>
    //lưu page
    var page;
    // lưu id sản phẩm chi tiết đang được select
    var selectedProduct;
    var selectedProductDetailId;
    var selectedProductDetailColor;
    var selectedProductDetailSize;
    var productDetail;
    var chooseColor = [];
    var chooseSize = [];

    window.onload = function () {
        loadPage(0);
        chooseColor = [];
        chooseSize = [];
        selectedProduct = undefined;
    }

    async function loadPage(pageNumber) {
        var sort = document.getElementById('sort-elem').value;
        var url = "/api/client/product/page/" + pageNumber + "/" + "null" + "?sort="+sort;
        var request = requestConfig(chooseColor, chooseSize);
        console.log(request);
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(request)
        });
        page = pageNumber;
        var result = await response.json();
        var list = result.content;
        console.log(list);
        var totalPage = result.totalPages;
        var number = result.number;
        var main = '';
        var color = '';
        var labelColor = '';
        var cssStyle = '';
        var size = '';
        var index;
        for (i = 0; i < list.length; i++) {
            var urlDetailPD = '/api/client/product_detail/detailPD/' + list[i].id;
            const responseDetailPD = await fetch(urlDetailPD, {
                method: 'GET'
            });
            const data = await responseDetailPD.json();
            let resultDetailColor = data.filter((product, index, self) =>
                index === self.findIndex((p) => (
                    p.ms.id === product.ms.id
                ))
            );
            // Sort colors based on ms.id
            resultDetailColor.sort((a, b) => a.ms.id - b.ms.id);
            index = i;
            for (j = 0; j < resultDetailColor.length; j++) {
                if (list[i].id === resultDetailColor[j].sp.id) {
                    var name = resultDetailColor[j].ms.id;
                    if (resultDetailColor[j].ms.id === 1) {
                        labelColor = "btn-dark";
                        cssStyle = "";
                    } else if (resultDetailColor[j].ms.id === 2) {
                        cssStyle = "";
                        labelColor = "btn-light";
                    } else if (resultDetailColor[j].ms.id === 3) {
                        cssStyle = "";
                        labelColor = "btn-danger";
                    } else if (resultDetailColor[j].ms.id === 4) {
                        labelColor = "btn-secondary";
                        cssStyle = "style=\"background-color: rgb(169,169,169); border: none;\"";
                    } else if (resultDetailColor[j].ms.id === 5) {
                        cssStyle = "";
                        labelColor = "btn-success";
                    } else if (resultDetailColor[j].ms.id === 6) {
                        cssStyle = "";
                        labelColor = "btn-secondary";
                    } else if (resultDetailColor[j].ms.id === 7) {
                        cssStyle = "";
                        labelColor = "btn-primary";
                    } else {
                        cssStyle = "";
                        labelColor = "btn-warning";
                    }
                    color += `<li><input type="radio" value="${name}" name="product-color" id="product-color-${index}${name}" onclick="chooseProductColor(${list[i].id},${index},${name},${j + 1})"><label class="avatar-xxs btn ${labelColor} p-0 d-flex align-items-center justify-content-center rounded-circle" for="product-color-${index}${name}" ${cssStyle}></label></li>`
                }
            }
            let resultDetailSize = data.filter((product, index, self) =>
                index === self.findIndex((p) => (
                    p.size === product.size
                ))
            );
            // Sort sizes based on size
            resultDetailSize.sort((a, b) => a.size.localeCompare(b.size));
            for (j = 0; j < resultDetailSize.length; j++) {
                if (list[i].id === resultDetailSize[j].sp.id) {
                    var name = resultDetailSize[j].size;
                    size += `<li data-value="${name}" class="li-size${list[i].id}"><input class="size-input${list[i].id}" disabled type="radio" value="${name}" name="product-size" id="product-size-${index}${j + 1}" onclick="chooseProductSize(${list[i].id},${index},${j + 1})"><label class="avatar-xxs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle" for="product-size-${index}${j + 1}" >${resultDetailSize[j].size}</label></li>`
                }
            }
            main += `<div class="col-xxl-3 col-xxl-3 col-md-6">
                        <div class="card ecommerce-product-widgets border-0 rounded-0 shadow-none overflow-hidden">
                            <div class="bg-light bg-opacity-50 rounded py-4 position-relative"><img
                                    src="../assets/images/products/img-8.png" alt=""
                                    style="max-height: 200px;max-width: 100%;" class="mx-auto d-block rounded-2">
                                <div class="action vstack gap-2">
                                    <button class="btn btn-danger avatar-xs p-0 btn-soft-warning custom-toggle product-action "
                                            data-bs-toggle="button"><span class="icon-on"><i class="ri-heart-line"></i></span>
                                        <span class="icon-off"><i class="ri-heart-fill"></i></span></button>
                                </div>
                                <div class="avatar-xs label">
                                    <div class="avatar-title bg-danger rounded-circle fs-11">25%</div>
                                </div>
                            </div>
                            <div class="pt-4">
                                <div>
                                    <ul class="clothe-colors list-unstyled hstack gap-1 mb-3 flex-wrap" style="height: 35px" >${color}</ul>
                                    <ul class="clothe-size list-unstyled hstack gap-1 mb-3 flex-wrap" style="height: 35px">${size}</ul>
                                    <a href="#!"><h6 class="text-capitalize fs-15 lh-base text-truncate mb-0">${list[i].tenSP}</h6></a>
                                    <div class="mt-2">
                                        <h5 class="text-secondary mb-0">${formatMoney(list[i].donGia)}
                                        </h5>
                                    </div>
                                    <div class="tn mt-3"><button onclick="AddToCart()" class="btn btn-primary btn-hover w-100 add-btn"><i
                                            class="mdi mdi-cart me-1"></i> Add To Cart</button></div>
                                </div>
                            </div>
                        </div>
                    </div>`
            color = '';
            size = '';
        }
        document.getElementById("product-grid").innerHTML = main;

        var currentPage = `
             <div class="col-lg-12">
                        <div
                                class="pagination-block pagination pagination-separated justify-content-center justify-content-sm-center mb-sm-0"
                        >
                            <div class="pagination-wrap hstack gap-2">
                                <a class="page-item pagination-prev" id="pagination-start" onclick="loadPage(0)">
                                    <i class="mdi mdi-chevron-double-left align-middle ms-1" ></i> </a>
                                </a>
                                <a class="page-item pagination-prev" id="pagination-prev" onclick="loadPage(${number - 1})">
                                    <i class="mdi mdi-chevron-left align-middle ms-1"></i> </a>
                                </a>
                                <ul class="pagination listjs-pagination mb-0"><li class="active"><a class="page" data-i="1" data-page="10">${number + 1}</a></li>
                                </ul>
                                <a class="page-item pagination-next" id="pagination-next" onclick="loadPage(${number + 1})">
                                    <i class="mdi mdi-chevron-right align-middle ms-1"></i></a>
                                </a>
                                <a class="page-item pagination-next" id="pagination-end" onclick="loadPage(${totalPage - 1})">
                                    <i class="mdi mdi-chevron-double-right align-middle ms-1"></i></a>
                                </a>
                            </div>
                        </div>
                    </div>
        `;
        document.getElementById("pagination-element").innerHTML = currentPage;
        if (number === 0 && number === totalPage - 1) {
            document.getElementById('pagination-start').style.display = "none";
            document.getElementById('pagination-prev').style.display = "none";
            document.getElementById('pagination-next').style.display = "none";
            document.getElementById('pagination-end').style.display = "none";
        } else if (number === 0) {
            document.getElementById('pagination-start').style.display = "none";
            document.getElementById('pagination-prev').style.display = "none";
            document.getElementById('pagination-next').style.display = "block";
            document.getElementById('pagination-end').style.display = "block";
        } else if (number === totalPage - 1) {
            document.getElementById('pagination-start').style.display = "block";
            document.getElementById('pagination-prev').style.display = "block";
            document.getElementById('pagination-next').style.display = "none";
            document.getElementById('pagination-end').style.display = "none";
        }
    }

    function requestConfig(arrColor, arrSize) {
        let filterRequest = {};
        if (arrColor.length === 0 && arrSize.length !== 0) {
            console.log(arrColor);
            filterRequest = {listColors: null, listSizes: arrSize};
        } else if (arrColor.length !== 0 && arrSize.length === 0) {
            console.log(arrSize);
            filterRequest = {listColors: arrColor, listSizes: null};
        } else if (arrColor.length === 0 && arrSize.length === 0) {
            console.log(arrColor, arrSize);
            filterRequest = {listColors: null, listSizes: null};
        } else {
            console.log(arrColor, arrSize);
            filterRequest = {listColors: arrColor, listSizes: arrSize};
        }
        return filterRequest;
    }

    function formatMoney(money) {
        const VND = new Intl.NumberFormat('vi-VN', {
            style: 'currency',
            currency: 'VND',
        });
        return VND.format(money);
    }

    async function chooseProductColor(idPD, indexId, id, index) {
        var url = "/api/client/product_detail/detail/" + idPD + "/" + id;
        var arrSize = [];
        var liSize = document.querySelectorAll('li.li-size' + idPD);
        var inputSize = document.querySelectorAll('input.size-input' + idPD);
        const response = await fetch(url, {
            method: 'GET'
        });
        var result = await response.json();
        if (selectedProduct === undefined && selectedProductDetailColor === undefined) {
            arrSize = [];
            selectedProduct = idPD;
            selectedProductDetailColor = id;
            for (i = 0; i < result.length; i++) {
                inputSize.forEach(function (inputs) {
                    var a = inputs.value.toLowerCase();
                    var b = result[i].size.toLowerCase();
                    if (b === a) {
                        inputs.removeAttribute('disabled');
                        arrSize.push(inputs.value);
                    }
                });
            }
        } else {
            if (selectedProduct === idPD && selectedProductDetailColor !== id) {
                arrSize = [];
                selectedProductDetailColor = id;
                selectedProductDetailSize = undefined;
                for (i = 0; i < result.length; i++) {
                    inputSize.forEach(function (inputs) {
                        var a = inputs.value.toLowerCase();
                        var b = result[i].size.toLowerCase();
                        if (b === a) {
                            inputs.checked = false;
                            inputs.removeAttribute('disabled');
                            arrSize.push(inputs.value);
                        }
                    });
                }
            } else {
                var radioInputs = document.querySelectorAll('input[type="radio"]');
                var idToRemove = "product-color-" + indexId + id;
                for (var i = 0; i < radioInputs.length; i++) {
                    if (radioInputs[i].id === idToRemove) {
                        // Loại bỏ checked = false cho các phần tử radio trừ phần tử hiện tại
                        for (var j = 0; j < radioInputs.length; j++) {
                            if (j !== i) {
                                radioInputs[j].checked = false;
                            }
                        }
                        break;
                    }
                }
                selectedProduct = idPD;
                selectedProductDetailColor = id;
                arrSize = [];
                for (i = 0; i < result.length; i++) {
                    inputSize.forEach(function (inputs) {
                        var a = inputs.value.toLowerCase();
                        var b = result[i].size.toLowerCase();
                        if (b === a) {
                            inputs.removeAttribute('disabled');
                            arrSize.push(inputs.value);
                        }
                    });
                }
            }
        }

        liSize.forEach(function (li) {
            var a = li.dataset.value.toLowerCase();
            var matchFound = false;
            for (i = 0; i < arrSize.length; i++) {
                var b = arrSize[i].toLowerCase();
                if (a === b) {
                    matchFound = true;
                    break;
                }
            }
            if (!matchFound) {
                li.style.display = 'none';
            } else {
                li.style.display = 'block';
            }
        });
    }

    function chooseProductSize(idPD, indexId, id) {
        //lưu size selectSize
        selectedProduct = idPD;
        var nameSize = document.getElementById('product-size-' + indexId + id);
        selectedProductDetailSize = nameSize.value;
    }

    function ClearAll() {
        // var keyword = document.getElementById("searchProductList").value.trim().toLowerCase();
        // var priceMin = document.getElementById("minCost").value.trim().toLowerCase();
        // var priceMax = document.getElementById("maxCost").value.trim().toLowerCase();
        // // var colorFilter = document.getElementById("color-filter").value;
        // // var sizeFilter = document.getElementById("size-filter").value;
        // var colorFilter = 0;
        // var sizeFilter = '';
        // keyword = '';
        // priceMin = '';
        // priceMax = '';
    }

    async function AddToCart() {
        let product = {};
        if (selectedProductDetailColor === undefined && selectedProductDetailSize === undefined) {
            alert("Chưa chọn màu và size !");
        } else if (selectedProductDetailColor === undefined) {
            alert("Chưa chọn màu !");
        } else if (selectedProductDetailSize === undefined) {
            alert("Chưa chọn size !");
        } else {
            product = {idSP: selectedProduct, ms: selectedProductDetailColor, size: selectedProductDetailSize};
            console.log(product);
            var url = '/api/client/cart_detail/add';
            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(product)
            });
            console.log(response);
            if (response.status === 200) {
                alert("Oke");
            } else {
                alert("Not oke");
            }
        }
    }

    async function searchProduct(pageNumber) {
        var keyword = document.getElementById("searchProductList").value.trim().toLowerCase();
        var priceMin = document.getElementById("minCost").value.trim().toLowerCase();
        var priceMax = document.getElementById("maxCost").value.trim().toLowerCase();
        var checkboxColorFilter;
        var checkboxSizeFilter;
        //=>Color
        // Lấy tất cả các phần tử input checkbox trong danh sách
        var checkboxesColor = document.querySelectorAll('#color-filter input[type="checkbox"]');
        // Lọc các phần tử được chọn
        var checkedCheckboxesColor = Array.from(checkboxesColor).filter(checkbox => checkbox.checked);
        // Lấy giá trị của các phần tử được chọn
        var colorFilter = checkedCheckboxesColor.map(checkbox => checkbox.value);
        //=>Size
        var checkboxesSize = document.querySelectorAll('#size-filter input[type="checkbox"]');
        // Lọc các phần tử được chọn
        var checkedCheckboxesSize = Array.from(checkboxesSize).filter(checkbox => checkbox.checked);
        // Lấy giá trị của các phần tử được chọn
        var sizeFilter = checkedCheckboxesSize.map(checkbox => checkbox.value);


        //Log input
        console.log("1.keyword: " + keyword);
        console.log("2.priceMin: " + priceMin);
        console.log("3.priceMax: " + priceMax);
        console.log("4.colorFilter: " + colorFilter);
        console.log("5.sizeFilter: " + sizeFilter);
        var url;
        if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            loadPage(page);
        }
        //search
        else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("keyword 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("keyword page");
        }
        //search+price
        else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+priceMin 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+priceMin page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+priceMax 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+priceMax page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+price 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("search+price page");
        }
        //search+color
        else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search + color 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search + color page");
        }
        //search+size
        else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search + size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search + size page");
        }
        //search+color+size
        else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search + color + size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search + color + size page");
        }
        //search+price+color
        else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+priceMin+color 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+priceMin+color page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+priceMax+color 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+priceMax+color page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+price+color 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("search+price+color page");
        }
        //search+price+size
        else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMin+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMin+size page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMax+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMax+size page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+price+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("search+price+size page");
        }
        //search+price+color+size
        else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMin+color+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMin+color+size page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMax+color+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+priceMax+color+size page");
        } else if (pageNumber === undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+price+color+size 0");
        } else if (pageNumber !== undefined && keyword !== '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + keyword + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("search+price+color+size page");
        }
        //price
        else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("priceMin 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("priceMin page");
        } else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("priceMax 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("priceMax page");
        } else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("price 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + "null";
            console.log(url);
            console.log("price page");
        }
        //price+color
        else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("priceMin+color 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("priceMin+color page");
        } else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("priceMax+color 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("priceMax+color page");
        } else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("price+color 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("price+color page");
        }
        //price+size
        else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("priceMin+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("priceMin+size page");
        } else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("priceMax+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("priceMax+size page");
        } else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("price+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("price+size page");
        }
        //price+color+size
        else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("priceMin+color+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("priceMin+color+size page");
        } else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("priceMax+color+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax !== '' && chooseColor.length > 0 && colorFilter !== '') {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + priceMax + "/" + colorFilter + "/" + colorFilter;
            console.log(url);
            console.log("priceMax+color+size page");
        } else if (pageNumber === undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("price+color+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin !== '' && priceMax !== '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + priceMin + "/" + priceMax + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("price+color+size page");
        }
        //color
        else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("color 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length === 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + "null";
            console.log(url);
            console.log("color page");
        }
        //size
        else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length === 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + "null" + "/" + 0 + "/" + sizeFilter;
            console.log(url);
            console.log("size page");
        }
        //color+size
        else if (pageNumber === undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + 0 + "/" + "null" + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("color+size 0");
        } else if (pageNumber !== undefined && keyword === '' && priceMin === '' && priceMax === '' && chooseColor.length > 0 && chooseSize.length > 0) {
            url = "/api/client/product/page/" + pageNumber + "/" + "null" + "/" + "null" + "/" + "null" + "/" + colorFilter + "/" + sizeFilter;
            console.log(url);
            console.log("color+size page");
        }
        const response = await fetch(url, {
            method: 'GET'
        });
        page = pageNumber;
        var result = await response.json();
        var list = result.content;
        var totalPage = result.totalPages;
        var number = result.number;
        var main = '';
        var color = '';
        var labelColor = '';
        var cssStyle = '';
        var size = '';
        var index;
        for (i = 0; i < list.length; i++) {
            var urlDetailPD = '/api/client/product_detail/detailPD/' + list[i].id;
            const responseDetailPD = await fetch(urlDetailPD, {
                method: 'GET'
            });
            const data = await responseDetailPD.json();
            let resultDetailColor = data.filter((product, index, self) =>
                index === self.findIndex((p) => (
                    p.ms.id === product.ms.id
                ))
            );
            // Sort colors based on ms.id
            resultDetailColor.sort((a, b) => a.ms.id - b.ms.id);
            index = i;
            for (j = 0; j < resultDetailColor.length; j++) {
                if (list[i].id === resultDetailColor[j].sp.id) {
                    if (resultDetailColor[j].ms.id === 1) {
                        labelColor = "btn-dark";
                        cssStyle = "";
                    } else if (resultDetailColor[j].ms.id === 2) {
                        cssStyle = "";
                        labelColor = "btn-light";
                    } else if (resultDetailColor[j].ms.id === 3) {
                        cssStyle = "";
                        labelColor = "btn-danger";
                    } else if (resultDetailColor[j].ms.id === 4) {
                        labelColor = "btn-secondary";
                        cssStyle = "style=\"background-color: rgb(169,169,169); border: none;\"";
                    } else if (resultDetailColor[j].ms.id === 5) {
                        cssStyle = "";
                        labelColor = "btn-success";
                    } else if (resultDetailColor[j].ms.id === 6) {
                        cssStyle = "";
                        labelColor = "btn-secondary";
                    } else if (resultDetailColor[j].ms.id === 7) {
                        cssStyle = "";
                        labelColor = "btn-primary";
                    } else {
                        cssStyle = "";
                        labelColor = "btn-warning";
                    }
                    color += `<li><input type="radio" value="${resultDetailColor[j].ms.id}" name="product-color" id="product-color-${index}${resultDetailColor[j].ms.id}" onclick="chooseProductColor(${list[i].id},${index},${resultDetailColor[j].ms.id},${j + 1})"><label class="avatar-xxs btn ${labelColor} p-0 d-flex align-items-center justify-content-center rounded-circle" for="product-color-${index}${resultDetailColor[j].ms.id}" ${cssStyle}></label></li>`
                }
            }
            let resultDetailSize = data.filter((product, index, self) =>
                index === self.findIndex((p) => (
                    p.size === product.size
                ))
            );
            // Sort sizes based on size
            resultDetailSize.sort((a, b) => a.size.localeCompare(b.size));
            for (j = 0; j < resultDetailSize.length; j++) {
                if (list[i].id === resultDetailSize[j].sp.id) {
                    size += `<li data-value="${resultDetailSize[j].size}" class="li-size${list[i].id}"><input class="size-input${list[i].id}" disabled type="radio" value="${resultDetailSize[j].size}" name="product-size" id="product-size-${index}${j + 1}" onclick="chooseProductSize(${list[i].id},${index},${j + 1})"><label class="avatar-xxs btn btn-soft-primary p-0 d-flex align-items-center justify-content-center rounded-circle" for="product-size-${index}${j + 1}" >${resultDetailSize[j].size}</label></li>`
                }
            }
            main += `<div class="col-xxl-3 col-xxl-3 col-md-6">
                        <div class="card ecommerce-product-widgets border-0 rounded-0 shadow-none overflow-hidden">
                            <div class="bg-light bg-opacity-50 rounded py-4 position-relative"><img
                                    src="../assets/images/products/img-8.png" alt=""
                                    style="max-height: 200px;max-width: 100%;" class="mx-auto d-block rounded-2">
                                <div class="action vstack gap-2">
                                    <button class="btn btn-danger avatar-xs p-0 btn-soft-warning custom-toggle product-action "
                                            data-bs-toggle="button"><span class="icon-on"><i class="ri-heart-line"></i></span>
                                        <span class="icon-off"><i class="ri-heart-fill"></i></span></button>
                                </div>
                                <div class="avatar-xs label">
                                    <div class="avatar-title bg-danger rounded-circle fs-11">25%</div>
                                </div>
                            </div>
                            <div class="pt-4">
                                <div>
                                    <ul class="clothe-colors list-unstyled hstack gap-1 mb-3 flex-wrap" style="height: 35px" >${color}</ul>
                                    <ul class="clothe-size list-unstyled hstack gap-1 mb-3 flex-wrap" style="height: 35px">${size}</ul>
                                    <a href="#!"><h6 class="text-capitalize fs-15 lh-base text-truncate mb-0">${list[i].tenSP}</h6></a>
                                    <div class="mt-2">
                                        <h5 class="text-secondary mb-0">${formatMoney(list[i].donGia)}
<!--<span class="text-muted fs-12"><del>$354.99</del></span>-->
                                        </h5>
                                    </div>
                                    <div class="tn mt-3"><button onclick="AddToCart()" class="btn btn-primary btn-hover w-100 add-btn"><i
                                            class="mdi mdi-cart me-1"></i> Add To Cart</button></div>
                                </div>
                            </div>
                        </div>
                    </div>`
            color = '';
            size = '';
        }
        document.getElementById("product-grid").innerHTML = main;

        var currentPage = `
             <div class="col-lg-12">
                        <div
                                class="pagination-block pagination pagination-separated justify-content-center justify-content-sm-center mb-sm-0"
                        >
                            <div class="pagination-wrap hstack gap-2">
                                <button class="page-item pagination-prev" id="pagination-start" onclick="searchProduct(0)">
                                    <i class="mdi mdi-chevron-double-left align-middle ms-1" ></i> </button>
                                </a>
                                <button class="page-item pagination-prev" id="pagination-prev" onclick="searchProduct(${number - 1})">
                                    <i class="mdi mdi-chevron-left align-middle ms-1"></i> </button>
                                </a>
                                <ul class="pagination listjs-pagination mb-0"><li class="active"><button class="page" data-i="1" data-page="10">${number + 1}</button></li>
                                </ul>
                                <button class="page-item pagination-next" id="pagination-next" onclick="searchProduct(${number + 1})">
                                    <i class="mdi mdi-chevron-right align-middle ms-1"></i></button>
                                </a>
                                <button class="page-item pagination-next" id="pagination-end" onclick="searchProduct(${totalPage - 1})">
                                    <i class="mdi mdi-chevron-double-right align-middle ms-1"></i></button>
                                </a>
                            </div>
                        </div>
                    </div>
        `;
        document.getElementById("pagination-element").innerHTML = currentPage;
        if (number === 0 && number === totalPage - 1) {
            document.getElementById('pagination-start').style.display = "none";
            document.getElementById('pagination-prev').style.display = "none";
            document.getElementById('pagination-next').style.display = "none";
            document.getElementById('pagination-end').style.display = "none";
        } else if (number === 0) {
            document.getElementById('pagination-start').style.display = "none";
            document.getElementById('pagination-prev').style.display = "none";
            document.getElementById('pagination-next').style.display = "block";
            document.getElementById('pagination-end').style.display = "block";
        } else if (number === totalPage - 1) {
            document.getElementById('pagination-start').style.display = "block";
            document.getElementById('pagination-prev').style.display = "block";
            document.getElementById('pagination-next').style.display = "none";
            document.getElementById('pagination-end').style.display = "none";
        }
    }

    function chooseFilterColor(id) {
        // Kiểm tra xem ID đã được chọn có trong danh sách hay không?
        var index = chooseColor.indexOf(id);
        var numberParse = parseInt(id);
        if (index === -1) {
            // Nếu không tìm thấy, thêm ID vào danh sách!
            chooseColor.push(numberParse);
            console.log(chooseColor);
            loadPage(0);
        } else {
            // Nếu tìm thấy, loại bỏ ID khỏi danh sách!
            chooseColor.splice(index, 1);
            console.log(chooseColor);
            loadPage(0);
        }
    }

    function chooseFilterSize(id) {
        var checkboxSize = document.getElementById("size" + id);
        // Kiểm tra xem ID đã được chọn có trong danh sách hay không?
        var index = chooseSize.indexOf(checkboxSize.value);
        if (index === -1) {
            // Nếu không tìm thấy, thêm ID vào danh sách!
            chooseSize.push(checkboxSize.value);
            console.log(chooseSize);
            loadPage(0);
        } else {
            // Nếu tìm thấy, loại bỏ ID khỏi danh sách!
            chooseSize.splice(index, 1);
            console.log(chooseSize);
            loadPage(0);
        }
    }
</script>
</body>
</html>
